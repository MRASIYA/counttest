<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Contact Hub - Google Apps Script Integration</title>
    <meta name="description" content="A modern web application integrated with Google Apps Script for seamless data processing">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <h1>Web2</h1>
            </div>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="home" class="hero">
            <div class="hero-content">
                <h2>Smart Contact Hub</h2>
                <p>Seamlessly integrated with Google Apps Script for powerful data processing and automation</p>
                <button class="cta-button" onclick="testGoogleScript()">Test Integration</button>
            </div>
        </section>

        <section id="about" class="section">
            <div class="container">
                <h2>About Smart Contact Hub</h2>
                <p>This modern web application demonstrates seamless integration with Google Apps Script. Our contact form directly connects to Google's cloud infrastructure, enabling powerful data processing, automated workflows, and real-time responses. Built with responsive design principles and modern web technologies for optimal performance across all devices.</p>
                <div class="integration-status" id="integrationStatus">
                    <p><strong>Integration Status:</strong> <span id="statusIndicator">Checking connection...</span></p>
                </div>
            </div>
        </section>

        <section id="services" class="section">
            <div class="container">
                <h2>Features</h2>
                <div class="services-grid">
                    <div class="service-card">
                        <h3>üîó Google Apps Script Integration</h3>
                        <p>Direct connection to Google Apps Script for seamless data processing and automation</p>
                    </div>
                    <div class="service-card">
                        <h3>üìä Real-time Data Processing</h3>
                        <p>Instant form submissions and data handling through Google's cloud infrastructure</p>
                    </div>
                    <div class="service-card">
                        <h3>üì± Responsive Design</h3>
                        <p>Works perfectly on all devices with modern web standards</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="section">
            <div class="container">
                <h2>Contact</h2>
                
                <!-- Google Apps Script Form Display -->
                <div class="gas-form-container">
                    <h3>üìã Google Apps Script Form</h3>
                    <p>View and interact with the Google Apps Script form directly:</p>
                    
                    <div class="form-tabs">
                        <button class="tab-button active" onclick="showLocalForm()">Local Form</button>
                        <button class="tab-button" onclick="showGoogleForm()">Google Script Form</button>
                        <button class="tab-button" onclick="openGoogleFormNewTab()">Open in New Tab</button>
                    </div>
                    
                    <!-- Local Contact Form -->
                    <div id="localForm" class="form-container active">
                        <h4>Local Contact Form (Submits to Google Apps Script)</h4>
                        <form class="contact-form" id="contactForm">
                            <input type="text" name="name" placeholder="Your Name" required>
                            <input type="email" name="email" placeholder="Your Email" required>
                            <textarea name="message" placeholder="Your Message" rows="5" required></textarea>
                            <button type="submit">Send Message</button>
                        </form>
                    </div>
                    
                    <!-- Google Apps Script Form Embed -->
                    <div id="googleForm" class="form-container">
                        <h4>Google Apps Script Form (Direct Access)</h4>
                        
                        <!-- Main iframe container -->
                        <div class="iframe-container" id="iframeContainer">
                            <div class="iframe-loading" id="loadingMessage">
                                <h3>üîÑ Loading Google Apps Script Form...</h3>
                                <p>Please wait while we load your form.</p>
                            </div>
                            <iframe 
                                id="googleScriptFrame"
                                src="https://script.google.com/macros/s/AKfycbyZwQrxxXeDnT1llTZb3h7Mj059z4y_3JuKnmQ2p5yIdQXbxttoDblg4coapbSy-gkq/exec"
                                width="100%" 
                                height="600"
                                frameborder="0"
                                scrolling="auto"
                                title="Google Apps Script Form"
                                onload="hideLoadingMessage()"
                                onerror="showIframeError()">
                                <p>Your browser does not support iframes.</p>
                            </iframe>
                        </div>
                        
                        <!-- Fallback options -->
                        <div class="fallback-options" id="fallbackOptions" style="display: none;">
                            <h4>‚ö†Ô∏è Direct Embedding Not Available</h4>
                            <p>Google Apps Script may restrict iframe embedding. Please use one of these options:</p>
                            
                            <div style="text-align: center; margin: 2rem 0;">
                                <a href="https://script.google.com/macros/s/AKfycbyZwQrxxXeDnT1llTZb3h7Mj059z4y_3JuKnmQ2p5yIdQXbxttoDblg4coapbSy-gkq/exec" 
                                   target="_blank" 
                                   class="gas-direct-link">
                                    üöÄ Open Google Apps Script Form
                                </a>
                            </div>
                            
                            <div class="alternative-info">
                                <h5>üìã Form Details:</h5>
                                <ul style="text-align: left; margin: 1rem 0; padding-left: 2rem;">
                                    <li><strong>URL:</strong> <code>https://script.google.com/macros/s/AKfycbyZwQrxxXeDnT1llTZb3h7Mj059z4y_3JuKnmQ2p5yIdQXbxttoDblg4coapbSy-gkq/exec</code></li>
                                    <li><strong>Purpose:</strong> Direct access to Google Apps Script form interface</li>
                                    <li><strong>Features:</strong> Real-time data processing and cloud storage</li>
                                </ul>
                            </div>
                        </div>
                        
                        <p class="iframe-note">üí° If the embedded form doesn't appear, Google Apps Script may have iframe restrictions. Use the "Open in New Tab" button above for direct access.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Web2 Project. All rights reserved.</p>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>
